>一天以后，当奥师傅接收到司机端上下发的处罚通知书时，准会想起朋友拉他进“场站刷单群”的那个并不遥远的下午。

### 1. 产品逻辑分析
#### 1.1 产品预期收益
##### 平台收益

* 例如产品新增项的目的是鼓励在场站听单司机接短单，不要挑单，从而提升场站成交率
##### 用户收益

* 在该产品逻辑下，用户如跟随产品牵引，用户需要怎么做，需要付出什么成本，最后的收益是什么？
* 司机如优先接短订单，提升有短单需求乘客的用车体验，在规定时间内返回场站则可获得额外时长奖励；同等条件下，完成短单的司机能更快被派到长订单

#### 1.2 用户执行路径

##### 理想情况用户执行路径（产品设想）

* 在产品激励牵引下，用户规范的完成获益所设的要求，例如司机在进入场站围栏听单时，打开优先接短订单开关，被派到短订单时完成订单，在规定时间内返回场站继续听单，平台给予其时长奖励，司机能更快接到长订单。
* 在此路径下：乘客体验提升，司机接单更快，场站整体成交率提升

##### 等效执行路径（司机视角）

* 为获得上述奖励，是否有其他成本更低的执行路径，使得短期收益更大或者获益效率更高？例如司机在打开优先接短订单开关后，自己使用乘客账号发短订单，订单派单到自己的司机账号， 司机接单并完成(或伪造完成)该订单，司机获得相应奖励。
* 在此路径下：乘客体验无提升，司机接单更快，场站整体成交率降低



### 2. 作弊动机评估模型

* 在具体场景下，评估用户是否存在作弊动机是一件很难被具体量化判断的工作，用户都是有限理性的，视角和视野范围不一会导致评估参数和结论有很大差异。因实际场景评估需要纳入的业务参数和经验加权较多，通用性弱，在此我仅提供较抽象的逻辑层面的通用评估模型供参考。
* 作弊收益B - 作弊成本C = 实际收益NP > 期望收益BE > 0
  * 作弊收益B部分很好理解且可以量化，一般是产品逻辑层面设计决定，例如优先派单权益中的奖励时长
  * 作弊成本C涵盖内容较多，下文展开
  * 实际收益NP  >  期望收益BE：并非有正收益司机就会有动机作弊，NP需要达到司机期望时才会激发作弊动机（辅助理解：辛苦运动一个月才减重1斤，你会自动扩大评估范围去考虑这个事情值不值得继续做）
* 虽然上述模型在示例场景的NP很难量化，但在工作中还是有积极意义的，在实际作弊治理过程中，大部分时间无需去计算NP，我们做好定性分析就能事半功倍。从现状反推，如发现司机以等效执行路径作弊，那么这部分司机自己评估结果肯定是NP  > BE，而作弊收益B在具体产品场景下，是相对固定或者可计算的，例如奖励时长 = 短单服务时长 * 固定系数，现在模型只剩下成本C部分不可计算。从管控角度出发，我们有一个简单手段是提**高司机成本C**，使得整体的NP < BE，司机作弊得不偿失，就可以部分实现作弊治理目的。下文重点讨论作弊成本的问题



### 3. 作弊成本约束

为了提高司机作弊成本，我们首先需要了解司机作弊成本是什么&成本的类型，才能对症下药。在这里总结三种类型的作弊成本：**间接成本、直接成本、机会成本**，并引入一个重要的概念，**成本约束**：用户对作弊成本的整体考量，会自发的使自身作弊行为模式受到某种约束(可能是无意识的)，即作弊成本反向影响(或决定)作弊行为模式。

#### 3.1 成本约束三要素

##### 间接成本

* 账号、设备、时间
  * 这部分成本非一次性成本，账号(或手机号)、设备均可重复使用，用户对这部分成本感知较弱，单次作弊成本考量时甚至会忽略这部分的均摊成本。
* 约束
  * 账号和设备资源单位成本相对较高，对于非团伙类的作弊用户，因为无法通过规模化批量作弊降低边际成本， 所以维持有限的账号和设备资源是一个相对划算的方案；用户的作弊行为在少数账号和设备会呈现聚集特征
  * 对于团伙类作弊用户，规模化作弊可以支持其维护较多的账号和设备，用户作弊时在账号和设备层面会相对离散，但**拉长评估周期仍能通过团伙挖掘的方式识别其异常聚集的特征**；同时这里需要将时间成本纳入考量，团伙资源增多会相应引入额外的作弊运维成本，为压缩这部分成本，团伙作弊行为**在时间上会呈现聚集特征**。

##### 直接成本

* 单次作弊金钱成本
  * 以网约车作弊司机刷虚假订单为例，司-乘完单支付后，平台会对支付金额提成，乘客账号支付额P - 司机收入I = 平台提成PC，这里PC就是单次刷单作弊所付出的直接金钱成本
* 约束
  * 直接成本比较直观，所以约束也很容易推理，虚假订单的支付金额会在满足获益订单条件的基础上尽可能的小，例如短单规则是订单预估里程小于40公里，虚假订单很少会大于30公里，且大部分订单会发大跑小&延迟开始计费&提前结束计费
  * 备注：部分刷单司机会在结束计费用主动向平台报备乘客未上车，要求平台退款给乘客，这样作弊司机最终并未付出直接成本，在此路径下直接成本约束对司机作弊会部分失效。

##### 机会成本

> 通俗来讲机会成本指为了做S1事项，而放弃做S2事项可能带来的收益，S2事项应获得的收益即为做S1事项的机会成本。

* 以上述产品背景为例，在相同的时间内，司机选择了刷单作弊获得时长奖励收益，那么在该时间段内正常完成真实短订单获得的收益就是司机选择作弊的机会成本。

* 约束

  * 机会成本给司机作弊带来的约束在于：在特定场景下例如运力供给紧缺&订单普遍较优质(如大单等)时，理性司机会选择正常做单获益，而不会在该场景下选择作弊。对于反作弊工作的意义在于识别虚假订单时，这些特定场景的部分订单可以被当作“**安全噪声**”暂时判白，尽量做到从订单维度而不是从用户维度识别作弊风险，从而避免产生识别误伤。

    

### 4. 反作弊管控&治理

> 上文提到的作弊动机评估模型中，已拆解分析作弊成本C，另一个参数作弊收益B更为重要也更易被忽视，根据产品规则分析，作弊收益B表面看是一个可计算的常量，但从反作弊治理层面评估，B也可以是一个可控的**变量**，这取决于我们针对作弊行为是去做**管控**还是**治理**

#### 管控

* 用户完成作弊后，反作弊侧识别作弊用户，然后对用户进行处置，例如对司机刷虚假单关联的乘客账号做处置，提高司机再次作弊的成本；但需要注意的是，大部分作弊获益是准实时的，即司机完成作弊 - 司机获得权益 - 司机使用权益这个过程是相对较短的，反作弊识别&处置是在司机使用权益之后，即司机作弊目标已经实现，只是部分增加下次作弊成本，反作弊侧闭环识别&处置过程。

#### 治理

* 治理主要是指在产品层面接入反作弊识别，在**完成作弊 - 获得权益-行使权益** 几个节点之间完成**作弊识别 & 获益阻断**，即司机在作弊后无法获得相应收益，作弊收益B $\approx$ 0，即使可能因前置识别缺少部分特征导致识别漏过，平均来看司机作弊收益会变得不确定，整体小于预期收益，从而减弱司机作弊动机。治理工作需要联动产品侧将反作弊识别嵌入产品功能中，做产品的优化升级

![截屏2023-12-12 下午1.13.34.png](http://img-hxy021.didistatic.com/static/iportal/upload/362c4b64d84d1f4b46bb6ddabf92f711.png "截屏2023-12-12 下午1.13.34.png")

在实际的业务反作弊工作中，管控和治理两项工作一般是同步进行
* 管控工作接入周期短，见效快，能尽快减少作弊用户带来的负面影响，但随着攻击对抗加剧，管控效果会波动
* 治理工作需要熟悉产品逻辑，摸清用户作弊动机和作弊实施路径，平衡体验和安全运营，在合适的产品节点接入反作弊识别能力，阻断作弊用户获利；整体治理周期相对较长，但治理效果稳固且趋势持续向好。


### 后记

> 奥师傅在被反作弊识别处置和宣教后，痛定思痛，开始尝试更隐蔽巧妙的作弊手法。
>
> 同时产品治理反作弊接入也在排期开发中。。。



### 5. 结语

   近期在评估某项具体反作弊需求的过程中，在减弱作弊动机的部分，有一个选项是“从产品规则层面减少用户激励权益”，例如奖励时长从1小时降为20分钟，这时有同学提出“不能因为担心作弊有负面影响就违背产品设计初衷，产品激励是正向引导用户的主要手段"，“因噎废食”不可取，而这个观点之下的信息也正是反作弊工作的目标和意义所在：为业务发展保驾护航。

   本文仅以单场景举例分享在业务反作弊工作中的一些总结和思考，因信息敏感和篇幅限制无法深入讨论更细节的部分，有不妥之处请各位老师不吝赐教；在此抛砖引玉，诸位请洒潘江，各倾陆海云尔！谢谢